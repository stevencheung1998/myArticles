## 跨域

我们日常在前端的开发过程中，时常遇到跨域的问题。对于前后端分离的项目更是如此。那到底什么是跨域？如何去解决跨域



###  什么是跨域

跨域资源共享（Cross-Origin Resources Sharing，CROS）是浏览器的保护机制，它要求浏览器发起请求访问的必须是 **协议、域名、端口** 必须一致。如有在发送请求到过程中，有任何一项不同，就会由于是跨域请求导致请求失败。

![image-20220610195746238](D:\Users\Administrator\Desktop\myApp\front-end-learn-article\其他\跨域\跨域.assets\image-20220610195746238-16550235748211.png)



### 跨域失败

我们在开发过程中，经常碰到的一个跨域失败，会有两次请求。其实对于跨域 **CROS** ，有两种不同的请求类型：

- 简单跨域
- 复杂跨域



### 简单的跨域请求

简单跨域请求是指满足以下两个条件的请求。

1、HTTP方法是以下三种之一

- HEAD
- GET
- POST

2、HTTP的头信息不超出以下几个字段

- Accept
- Accept-Language
- Content-Language
- Last-Event-ID
- Content-Type：只限三个值:`application/x-www-form-urlencoded`、 `multipart/form-data` 、`text/plain`



### 复杂的跨域请求（带预检的跨域请求）

**任何一个不满足简单跨域请求要求的请求，即被认为是复杂请求，也称作带预检的跨域请求**



一个复杂请求不止发送一个包含通信内容的请求，其中最先发送的是一种`预检`请求（前端），此时作为服务端，也需要返回`预回应`作为响应。只有当`预检`请求成功返回，实际请求才开始执行。



预检请求是以 `OPTIONS`形势发送，并含有两项`CROS`特有的请求字段：

- Access-Control-Request-Method：该项内容是实际请求的种类，可以是GET、POST之类的简单请求，也可以是PUT、DELETE等等。
- Access-Control-Request-Headers：该项是一个以逗号分隔的列表，当中是复杂请求所使用的头部。



 `预检` 请求实际上就是在为之后的实际请求发送一个权限请求，在预回应返回的内容当中，服务端应当对这两项进行回复，以让浏览器确定请求是否能够成功完成。一旦预回应如期而至，所请求的权限也都已满足，才会发出真实请求，携带真实数据。